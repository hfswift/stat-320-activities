---
title: "In-class Activity 5: Inference for Medians"
author: "GROUP NUMBER: GROUP MEMBER NAMES"
format: html
embed-resources: true
html-math-method: mathml
execute: 
  warning: false
  echo: true
  error: false
---


```{r}
#| label: setup
#| message: false

library(readr)
library(ggformula)
library(mosaic)
```


# Part 1: Sign Test for Medians

## Part 1A: City Recycling Program

The sanitation department of a large city wants to investigate ways to reduce the amount of recyclable materials that are placed in the city’s landfill. By separating the recyclable material from the remaining garbage, the city could prolong the life of the landfill site.  More important, the number of trees needed to be harvested for paper products and aluminum needed for cans could be greatly reduced. From an analysis of recycling records from other cities, it is determined that if the average weekly amount of recyclable material is more than 5 pounds per household a commercial recycling firm could make a profit collecting the material. To determine the feasibility of the recycling plan, a random sample of 25 households was selected. The weekly weight of recyclable material (in pounds/week) for each household is given here. Does the weekly amount of recyclable material meet the standard of 5 pounds or more for this to be a profitable venture for the city? Use the data `city_recycling.csv` to assess the research question.

```{r}
#| label: city-data

recycle<-read_csv("city_recycling.csv")
```

1.1. Calculate the appropriate summary statistics and create a visualization of the data.

```{r}
#| label: #put label here -- must be unique and without spaces or characters

# put code here
```


1.2. Write out the null and alternative for the median:

>$H_0: \theta = 5$ pounds  *Insert answer here*

>$H_1: \theta > 5$ pounds  *Insert answer here*



1.3. Identify the number of values greater than the population median, $\theta$ by replacing the ____ with the right value.

```{r}
#| label: city-tally

tally(~Recycled_lbs > ____, data=recycle)
```


1.4. Calculate and interpret the p-value

```{r}
#| label: city-pvalue

pbinom(q = ___  , size = ____, prob = _____, lower.tail = ______)
```

> Insert answer here


1.5. Compare the results to the t-test:

```{r}
#| label: city-ttest

t.test(~Recycled_lbs, data = recycle, mu = 5, alternative = "greater")
```

> Insert answer here



## Part 1B: Using the SIGN.test() function in R

```{r}
#| label: install-bsda
#| eval: FALSE

install.packages("BSDA") #be sure to install this first if it is not in your package list! (Note: this only has to be done ONCE per computer. We used the `eval=FALSE` code in the code chunk instructions so this line of code is not run when you knit.)
```


```{r}
#| label: lib-bsda

library(BSDA)
```


Here is the code - notice that instead of `goal(~variable, data = mydata, ...)` we use the structure `goal(mydata$variable, ...)` 
```{r}
#| city-sign

SIGN.test(recycle$Recycled_lbs, md = 5, alternative = "greater")
```





# Part 2: Wilcoxon Signed Rank Test 

## Class Units Using Wilcoxon Signed Rank Test

2.1. Using the units data, rerun the test for the median units above 15 hours using the Wilcoxon Signed Rank Test. Compare and contrast the results with the Sign Test (Note Outline 4-7).

```{r}
#put code here
```

> Insert Answer here



**Bonus**
2.2. Calculate the Wilcoxon Signed Rank Test for the city data. Compare and contrast the results with the Sign Test. Which test would you choose to run and why? 

```{r}
#put code here
```

> Insert Answer here




# Part 3: Confidence Intervals

## Part 3A: Class Example

3.1. This was the code we ran in class. Update it to calculate a 85% confidence interval. 

```{r}
#| label: ci-ex1

example <- c(118, 125, 148, 163, 165, 185, 250)
n = length(example) #sample size
C = 0.95 #confidence level
p = 0.5 #percentile value for median

alpha_2 = (1 - C)/2
a = qbinom(alpha_2, n, p)  #location in ordered data of lower bound
b = n - a + 1    # location in ordered data of upper bound
1 - 2*pbinom(a - 1, n, p)  # actual achieved confidence

#Lower Bound
sort(example)[a] #be sure to sort data smallest to largest

#Upper Bound
sort(example)[b]
```


## Part 3B: Toy Example 2

3.2. Here is a new set of data find the 90% and 95% confidence interval

```{r}
#| label: ci-data2

example2<-c(55, 58, 61, 61, 62, 62, 62, 63, 63, 64, 66, 68, 68, 69, 69, 69, 70, 71, 72, 72)
```

```{r}
# put code here
```


3.3. Use the Sign Test function to verify:

```{r}
#| label: ci-ex2-sign

SIGN.test(_________, conf.level = ______)$Confidence.Intervals
```


**Bonus**

3.4. We can actually calculate a confidence interval for any percentile value, such as $Q_1$ and $Q_3$. Update the code 3.2 to calculate and interpret the confidence interval for the Third Quartile, $Q_3$ by finding the locations surrounding the percentile location that contains the closest achieved confidence.

```{r}
#copy and then edit code here
```

> Interpret the resulting CI


## Part 3C: City Recycling

The sanitation department of a large city wants to investigate ways to reduce the amount of recyclable materials that are placed in the city’s landfill.  By separating the recyclable material from the remaining garbage, the city could prolong the life of the landfill site.  More important, the number of trees needed to be harvested for paper products and aluminum needed for cans could be greatly reduced.  From an analysis of recycling records from other cities, it is determined that if the average weekly amount of recyclable material is more than 5 pounds per household a commercial recycling firm could make a profit collecting the material.  To determine the feasibility of the recycling plan, a random sample of 25 households I selected.  The weekly weight of recyclable material (in pounds/week) for each household is given here.  Determine an appropriate measure of the amount of recyclable waste from a typical household in the city within 95% confidence.

3.5. Use the "by-hand" method and the `SIGN.test()` to verify.

```{r}
# by hand calculation here
```

```{r}
#sign test verification here
```

On your note outline, answer the three questions once you have calculated the CI. 
